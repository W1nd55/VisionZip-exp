# SparseZip configuration for POPE

model:
  model_type: sparsezip
  model_path: liuhaotian/llava-v1.5-7b
  temperature: 0.0
  max_new_tokens: 16

  dominant: 54  # dynamic-K can override internally
  contextual: 12  # Optimized: slightly lower for better latency

  sparsezip:
    dynamic_k: true
    k_min: 20            # INCREASED from 8
    k_max: 48            # DECREASED from 58
    dynk:
      c: 10.0            # INCREASED from 7.0
      eps: 1.0e-3        # INCREASED from 1e-6

    alphas:
      attn: 1.0
      entropy: 0.6       # INCREASED from 0.3
      mutual: 0.8        # INCREASED from 0.5
    tau_feat: 0.15       # DECREASED from 0.2
    tau_sim: 0.08        # DECREASED from 0.1
    cross_beta: 0.0

    merging:
      contextual_num: 20 # INCREASED from 12
      kmeans_init_factor: 2.0
      kmeans_iters: 1    # DECREASED from 10
      agglomerative: false # DISABLED
    
    # Feature flags (explicit)
    skip_hybrid_attn: false  # Enable hybrid scoring
    skip_dynamic_k: false    # Enable dynamic-K
    skip_ctx_merge: false    # Enable contextual merging

runner:
  dataset: pope
  ann_path: null
  output_dir: ./outputs_eval
  warmup: 5
  seed: 42
  attn_implementation: "eager"
